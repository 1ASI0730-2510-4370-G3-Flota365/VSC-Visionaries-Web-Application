"use strict";(self["webpackChunkflota365_vue"]=self["webpackChunkflota365_vue"]||[]).push([[824],{6305:(e,t,s)=>{s.d(t,{A:()=>v});s(2675),s(9463),s(8706),s(2008),s(4346),s(2062),s(4782),s(2010),s(8111),s(1701),s(6099);var i=function(){var e=this,t=e._self._c;return t("div",[t("Header",{attrs:{title:"Gestión de Flota"}}),t("div",{staticClass:"dashboard-grid",staticStyle:{"margin-bottom":"1.875rem"}},[t("div",{staticClass:"stats-card"},[t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"flex-start"}},[t("div",[t("div",{staticClass:"stats-label"},[e._v("Total de Flotas")]),t("div",{staticClass:"stats-value"},[e._v(e._s(e.fleets.length))]),t("div",{staticStyle:{"font-size":"0.875rem",color:"#666"}},[e._v(" "+e._s(e.totalVehicles)+" vehículos en total ")])]),e._m(0)])]),e._l(e.fleets,(function(s){return t("div",{key:s.id,staticClass:"stats-card"},[t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"flex-start"}},[t("div",[t("div",{staticClass:"stats-label"},[e._v(e._s(s.name))]),t("div",{staticClass:"stats-value"},[e._v(e._s(s.vehicleCount))]),t("div",{style:{fontSize:"0.875rem",color:s.performance>=90?"var(--color-success)":"var(--color-warning)"}},[t("i",{class:["fas",s.performance>=90?"fa-check-circle":"fa-exclamation-circle"]}),e._v(" "+e._s(s.performance)+"% operativo ")])]),t("div",{staticClass:"stats-icon"},[t("i",{class:e.getFleetIcon(s.name)})])])])}))],2),t("div",{staticClass:"card",staticStyle:{"margin-bottom":"1.875rem"}},[t("div",{staticClass:"card-header"},[t("h2",{staticClass:"card-title"},[e._v("Gestión de Flotas")]),t("button",{staticClass:"btn btn-primary",on:{click:function(t){e.showNewFleetModal=!0}}},[t("i",{staticClass:"fas fa-plus",staticStyle:{"margin-right":"0.5rem"}}),e._v(" Nueva Flota ")])]),t("table",{staticClass:"data-table"},[e._m(1),t("tbody",e._l(e.fleets,(function(s){return t("tr",{key:s.id},[t("td",[e._v(e._s(s.code))]),t("td",[e._v(e._s(s.name))]),t("td",[e._v(e._s(s.description))]),t("td",[e._v(e._s(s.vehicleCount))]),t("td",[t("StatusBadge",{attrs:{status:s.status,text:e.getStatusText(s.status)}})],1),t("td",[t("div",{staticStyle:{width:"100%",height:"8px","background-color":"#f0f0f0","border-radius":"4px"}},[t("div",{staticStyle:{height:"100%","background-color":"var(--color-success)","border-radius":"4px"},style:{width:"".concat(s.performance,"%"),backgroundColor:e.getPerformanceColor(s.performance)}})]),t("span",{staticStyle:{"font-size":"0.75rem",color:"#666"}},[e._v(e._s(s.performance)+"%")])]),t("td",[t("button",{staticClass:"btn btn-secondary",staticStyle:{padding:"0.25rem 0.5rem","font-size":"0.813rem"},on:{click:function(t){return e.viewFleet(s)}}},[t("i",{staticClass:"fas fa-eye"})]),t("button",{staticClass:"btn btn-secondary",staticStyle:{padding:"0.25rem 0.5rem","font-size":"0.813rem"},on:{click:function(t){return e.editFleet(s)}}},[t("i",{staticClass:"fas fa-edit"})]),t("button",{staticClass:"btn btn-secondary",staticStyle:{padding:"0.25rem 0.5rem","font-size":"0.813rem"},on:{click:function(t){return e.showFleetStats(s)}}},[t("i",{staticClass:"fas fa-chart-line"})])])])})),0)])]),e.selectedFleet?t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("h2",{staticClass:"card-title"},[e._v(e._s(e.selectedFleet.name)+" ("+e._s(e.selectedFleet.code)+")")]),t("div",[e._m(2),t("button",{staticClass:"btn btn-primary",staticStyle:{"margin-left":"0.5rem"},on:{click:function(t){e.showAssignVehiclesModal=!0}}},[t("i",{staticClass:"fas fa-user-plus",staticStyle:{"margin-right":"0.5rem"}}),e._v(" Asignar vehículos ")])])]),t("div",{staticStyle:{"margin-top":"1.25rem","border-bottom":"1px solid var(--color-gray-medium)"}},[t("div",{staticStyle:{display:"flex",gap:"0.5rem","overflow-x":"auto"}},e._l(e.fleetTabs,(function(s,i){return t("button",{key:i,staticClass:"btn",style:{padding:"0.75rem 1.25rem",borderRadius:"4px 4px 0 0",backgroundColor:e.activeFleetTab===i?"var(--color-turquoise)":"transparent",color:e.activeFleetTab===i?"var(--color-text)":"",marginBottom:"-1px",borderBottom:e.activeFleetTab===i?"2px solid var(--color-turquoise)":""},on:{click:function(t){e.activeFleetTab=i}}},[e._v(" "+e._s(s)+" ")])})),0)]),t("div",{staticStyle:{padding:"1.25rem 0"}},[t("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"1.25rem"}},[t("div",{staticClass:"form-group",staticStyle:{width:"300px",margin:"0"}},[t("div",{staticStyle:{position:"relative"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.fleetVehicleSearch,expression:"fleetVehicleSearch"}],staticClass:"form-control",staticStyle:{"padding-right":"35px"},attrs:{type:"text",placeholder:"Buscar vehículo..."},domProps:{value:e.fleetVehicleSearch},on:{input:function(t){t.target.composing||(e.fleetVehicleSearch=t.target.value)}}}),t("i",{staticClass:"fas fa-search",staticStyle:{position:"absolute",right:"10px",top:"12px",color:"#666"}})])]),e._m(3)]),t("table",{staticClass:"data-table"},[e._m(4),t("tbody",e._l(e.fleetVehicles,(function(s){return t("tr",{key:s.id},[t("td",[e._v(e._s(s.plate))]),t("td",[e._v(e._s(s.model)+" "+e._s(s.year))]),t("td",[e._v(e._s(s.assignedDriver||"No asignado"))]),t("td",[t("StatusBadge",{attrs:{status:s.status,text:e.getStatusText(s.status)}})],1),t("td",[e._v(e._s(e.formatDate(s.lastService)))]),t("td",[e._v(e._s(e.formatDate(s.nextService)))]),e._m(5,!0)])})),0)]),t("Pagination",{attrs:{"current-page":e.fleetVehiclePage,"total-items":e.filteredFleetVehicles.length,"per-page":e.itemsPerPage,"item-label":"vehículos"},on:{"page-change":function(t){e.fleetVehiclePage=t}}})],1)]):e._e(),t("Modal",{attrs:{show:e.showAssignVehiclesModal,title:"Asignar vehículos a Flota"},on:{close:function(t){e.showAssignVehiclesModal=!1}}},[e.selectedFleet?t("div",[t("div",{staticStyle:{"margin-bottom":"1.25rem","border-bottom":"1px solid var(--color-gray-medium)"}},[t("div",{staticStyle:{display:"flex",gap:"0.5rem"}},[t("button",{staticClass:"btn",staticStyle:{padding:"0.75rem 1.25rem","border-radius":"4px 4px 0 0","background-color":"var(--color-turquoise)",color:"var(--color-text)","margin-bottom":"-1px","border-bottom":"2px solid var(--color-turquoise)"}},[e._v(" Vehículos disponibles ")]),t("button",{staticClass:"btn btn-secondary",staticStyle:{padding:"0.75rem 1.25rem","border-radius":"4px 4px 0 0","background-color":"transparent","margin-bottom":"-1px"}},[e._v(" Crear nuevo vehículo ")])])]),t("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-bottom":"1.25rem"}},[t("div",{staticClass:"form-group",staticStyle:{flex:"1",margin:"0"}},[t("div",{staticStyle:{position:"relative"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.assignVehicleSearch,expression:"assignVehicleSearch"}],staticClass:"form-control",staticStyle:{"padding-right":"35px"},attrs:{type:"text",placeholder:"Buscar vehículo por placa o modelo..."},domProps:{value:e.assignVehicleSearch},on:{input:function(t){t.target.composing||(e.assignVehicleSearch=t.target.value)}}}),t("i",{staticClass:"fas fa-search",staticStyle:{position:"absolute",right:"10px",top:"12px",color:"#666"}})])]),t("button",{staticClass:"btn btn-secondary",staticStyle:{"margin-left":"0.75rem"}},[t("i",{staticClass:"fas fa-filter",staticStyle:{"margin-right":"0.5rem"}}),e._v(" Filtros ")])]),t("div",{staticStyle:{height:"300px","overflow-y":"auto",border:"1px solid var(--color-gray-medium)","border-radius":"4px","margin-bottom":"1.25rem"}},[t("table",{staticStyle:{width:"100%","border-collapse":"collapse"}},[t("thead",{staticStyle:{position:"sticky",top:"0","background-color":"var(--color-gray-light)"}},[t("tr",[t("th",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid var(--color-gray-medium)"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectAllVehicles,expression:"selectAllVehicles"}],attrs:{type:"checkbox",id:"selectAll"},domProps:{checked:Array.isArray(e.selectAllVehicles)?e._i(e.selectAllVehicles,null)>-1:e.selectAllVehicles},on:{change:[function(t){var s=e.selectAllVehicles,i=t.target,a=!!i.checked;if(Array.isArray(s)){var l=null,r=e._i(s,l);i.checked?r<0&&(e.selectAllVehicles=s.concat([l])):r>-1&&(e.selectAllVehicles=s.slice(0,r).concat(s.slice(r+1)))}else e.selectAllVehicles=a},e.toggleAllVehicles]}})]),t("th",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid var(--color-gray-medium)"}},[e._v("Placa")]),t("th",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid var(--color-gray-medium)"}},[e._v("Modelo")]),t("th",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid var(--color-gray-medium)"}},[e._v("Año")]),t("th",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid var(--color-gray-medium)"}},[e._v("Estado")]),t("th",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid var(--color-gray-medium)"}},[e._v("Flota actual")])])]),t("tbody",e._l(e.availableVehicles,(function(s){return t("tr",{key:s.id},[t("td",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid #eee"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedVehiclesToAssign,expression:"selectedVehiclesToAssign"}],attrs:{type:"checkbox"},domProps:{value:s.id,checked:Array.isArray(e.selectedVehiclesToAssign)?e._i(e.selectedVehiclesToAssign,s.id)>-1:e.selectedVehiclesToAssign},on:{change:function(t){var i=e.selectedVehiclesToAssign,a=t.target,l=!!a.checked;if(Array.isArray(i)){var r=s.id,o=e._i(i,r);a.checked?o<0&&(e.selectedVehiclesToAssign=i.concat([r])):o>-1&&(e.selectedVehiclesToAssign=i.slice(0,o).concat(i.slice(o+1)))}else e.selectedVehiclesToAssign=l}}})]),t("td",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid #eee"}},[e._v(e._s(s.plate))]),t("td",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid #eee"}},[e._v(e._s(s.model))]),t("td",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid #eee"}},[e._v(e._s(s.year))]),t("td",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid #eee"}},[t("StatusBadge",{attrs:{status:s.status,text:e.getStatusText(s.status)}})],1),t("td",{staticStyle:{padding:"0.75rem","text-align":"left","border-bottom":"1px solid #eee"}},[e._v(e._s(s.fleet||"No asignado"))])])})),0)])]),t("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[t("div",[t("span",[e._v(e._s(e.availableVehicles.length)+" vehículos disponibles, "+e._s(e.selectedVehiclesToAssign.length)+" seleccionados")])]),t("div",{staticStyle:{display:"flex",gap:"0.75rem"}},[t("button",{staticClass:"btn btn-secondary",on:{click:function(t){e.showAssignVehiclesModal=!1}}},[e._v("Cancelar")]),t("button",{staticClass:"btn btn-primary",attrs:{disabled:0===e.selectedVehiclesToAssign.length},on:{click:e.assignVehicles}},[e._v(" Asignar vehículos seleccionados ")])])])]):e._e()]),t("Modal",{attrs:{show:e.showNewFleetModal,title:e.editingFleet.id?"Editar Flota":"Nueva Flota"},on:{close:function(t){e.showNewFleetModal=!1}},scopedSlots:e._u([{key:"footer",fn:function(){return[t("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(t){e.showNewFleetModal=!1}}},[e._v("Cancelar")]),t("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:e.saveFleet}},[e._v(e._s(e.editingFleet.id?"Actualizar":"Crear")+" flota")])]},proxy:!0}])},[t("form",{on:{submit:function(t){return t.preventDefault(),e.saveFleet.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label",attrs:{for:"fleetName"}},[e._v("Nombre *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.editingFleet.name,expression:"editingFleet.name"}],staticClass:"form-control",attrs:{type:"text",id:"fleetName",required:""},domProps:{value:e.editingFleet.name},on:{input:function(t){t.target.composing||e.$set(e.editingFleet,"name",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label",attrs:{for:"fleetDescription"}},[e._v("Descripción")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.editingFleet.description,expression:"editingFleet.description"}],staticClass:"form-control",attrs:{id:"fleetDescription",rows:"3"},domProps:{value:e.editingFleet.description},on:{input:function(t){t.target.composing||e.$set(e.editingFleet,"description",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{staticClass:"form-label",attrs:{for:"fleetStatus"}},[e._v("Estado")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.editingFleet.status,expression:"editingFleet.status"}],staticClass:"form-control",attrs:{id:"fleetStatus"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.editingFleet,"status",t.target.multiple?s:s[0])}}},[t("option",{attrs:{value:"active"}},[e._v("Activa")]),t("option",{attrs:{value:"inactive"}},[e._v("Inactiva")])])])])])],1)},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"stats-icon"},[t("i",{staticClass:"fas fa-truck-moving"})])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("ID")]),t("th",[e._v("Nombre")]),t("th",[e._v("Descripción")]),t("th",[e._v("Vehículos")]),t("th",[e._v("Estado")]),t("th",[e._v("Performance")]),t("th",[e._v("Acciones")])])])},function(){var e=this,t=e._self._c;return t("button",{staticClass:"btn btn-secondary"},[t("i",{staticClass:"fas fa-chart-bar",staticStyle:{"margin-right":"0.5rem"}}),e._v(" Reportes ")])},function(){var e=this,t=e._self._c;return t("div",[t("button",{staticClass:"btn btn-secondary"},[t("i",{staticClass:"fas fa-filter",staticStyle:{"margin-right":"0.5rem"}}),e._v(" Filtros ")]),t("button",{staticClass:"btn btn-secondary",staticStyle:{"margin-left":"0.5rem"}},[t("i",{staticClass:"fas fa-download",staticStyle:{"margin-right":"0.5rem"}}),e._v(" Exportar ")])])},function(){var e=this,t=e._self._c;return t("thead",[t("tr",[t("th",[e._v("Placa")]),t("th",[e._v("Modelo")]),t("th",[e._v("Conductor asignado")]),t("th",[e._v("Estado")]),t("th",[e._v("Último servicio")]),t("th",[e._v("Próximo servicio")]),t("th",[e._v("Acciones")])])])},function(){var e=this,t=e._self._c;return t("td",[t("button",{staticClass:"btn btn-secondary",staticStyle:{padding:"0.25rem 0.5rem","font-size":"0.813rem"}},[t("i",{staticClass:"fas fa-eye"})]),t("button",{staticClass:"btn btn-secondary",staticStyle:{padding:"0.25rem 0.5rem","font-size":"0.813rem",margin:"0 0.25rem"}},[t("i",{staticClass:"fas fa-exchange-alt"})]),t("button",{staticClass:"btn btn-secondary",staticStyle:{padding:"0.25rem 0.5rem","font-size":"0.813rem"}},[t("i",{staticClass:"fas fa-times"})])])}],l=s(9201),r=s(9258),o=(s(113),s(8980),s(1629),s(4423),s(4114),s(2712),s(4554),s(3288),s(2489),s(116),s(7588),s(8237),s(1699),s(8156),s(3500),s(6213)),c=s(6815),n=s(7767);const d={name:"FleetManagement",components:{Header:o.Y9,StatusBadge:o.Wh,Modal:o.aF,Pagination:o.dK},data:function(){return{fleets:(0,r.A)(c),vehicles:(0,r.A)(n),selectedFleet:null,activeFleetTab:0,fleetTabs:["Vehículos","Conductores","Rutas","Mantenimiento","Estadísticas"],fleetVehicleSearch:"",fleetVehiclePage:1,itemsPerPage:5,showAssignVehiclesModal:!1,assignVehicleSearch:"",selectedVehiclesToAssign:[],selectAllVehicles:!1,showNewFleetModal:!1,editingFleet:{name:"",description:"",status:"active"}}},computed:{totalVehicles:function(){return this.fleets.reduce((function(e,t){return e+t.vehicleCount}),0)},fleetVehicles:function(){var e=this;return this.selectedFleet?this.vehicles.filter((function(t){return t.fleet===e.selectedFleet.name})):[]},filteredFleetVehicles:function(){if(!this.fleetVehicleSearch)return this.fleetVehicles;var e=this.fleetVehicleSearch.toLowerCase();return this.fleetVehicles.filter((function(t){return t.plate.toLowerCase().includes(e)||t.model.toLowerCase().includes(e)||t.assignedDriver&&t.assignedDriver.toLowerCase().includes(e)}))},paginatedFleetVehicles:function(){var e=(this.fleetVehiclePage-1)*this.itemsPerPage,t=e+this.itemsPerPage;return this.filteredFleetVehicles.slice(e,t)},availableVehicles:function(){var e=this;return this.vehicles.filter((function(t){if(e.assignVehicleSearch){var s=e.assignVehicleSearch.toLowerCase();if(!t.plate.toLowerCase().includes(s)&&!t.model.toLowerCase().includes(s))return!1}return!t.fleet||t.fleet!==e.selectedFleet.name}))}},methods:{getStatusText:function(e){var t={active:"Activa",inactive:"Inactiva",warning:"En ruta"};return t[e]||e},getFleetIcon:function(e){var t={"Flota Principal":"fas fa-truck","Flota Secundaria":"fas fa-car","Flota Externa":"fas fa-shuttle-van"};return t[e]||"fas fa-truck-moving"},getPerformanceColor:function(e){return e>=90?"var(--color-success)":e>=70?"var(--color-warning)":"var(--color-error)"},formatDate:function(e){if(!e)return"N/A";var t=new Date(e);return t.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})},viewFleet:function(e){this.selectedFleet=e,this.activeFleetTab=0,this.fleetVehiclePage=1},editFleet:function(e){this.editingFleet=(0,l.A)({},e),this.showNewFleetModal=!0},showFleetStats:function(e){this.selectedFleet=e,this.activeFleetTab=4},toggleAllVehicles:function(){this.selectAllVehicles?this.selectedVehiclesToAssign=this.availableVehicles.map((function(e){return e.id})):this.selectedVehiclesToAssign=[]},assignVehicles:function(){var e=this;if(0!==this.selectedVehiclesToAssign.length){this.selectedVehiclesToAssign.forEach((function(t){var s=e.vehicles.find((function(e){return e.id===t}));s&&(s.fleet=e.selectedFleet.name)}));var t=this.fleets.findIndex((function(t){return t.id===e.selectedFleet.id}));-1!==t&&(this.fleets[t].vehicleCount+=this.selectedVehiclesToAssign.length,this.selectedFleet=(0,l.A)({},this.fleets[t])),this.showAssignVehiclesModal=!1,this.selectedVehiclesToAssign=[],this.selectAllVehicles=!1,alert("Se han asignado ".concat(this.selectedVehiclesToAssign.length," vehículos a la flota ").concat(this.selectedFleet.name))}},saveFleet:function(){var e=this;if(this.editingFleet.id){var t=this.fleets.findIndex((function(t){return t.id===e.editingFleet.id}));-1!==t&&(this.fleets.splice(t,1,(0,l.A)({},this.editingFleet)),this.selectedFleet&&this.selectedFleet.id===this.editingFleet.id&&(this.selectedFleet=(0,l.A)({},this.editingFleet)))}else{var s=Math.max.apply(Math,(0,r.A)(this.fleets.map((function(e){return e.id}))))+1,i="FL-".concat(String(s).padStart(3,"0")),a=(0,l.A)((0,l.A)({},this.editingFleet),{},{id:s,code:i,vehicleCount:0,performance:100});this.fleets.push(a),this.selectedFleet=a}this.showNewFleetModal=!1,this.editingFleet={name:"",description:"",status:"active"}}},created:function(){this.fleets.length>0&&(this.selectedFleet=this.fleets[0])}},u=d;var h=s(1656),f=(0,h.A)(u,i,a,!1,null,null,null);const v=f.exports}}]);